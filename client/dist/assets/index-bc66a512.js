import{_ as A,r as x,o as g,c as h,d as s,w as i,i as a,b as e,V as U,a7 as N,Q as $,a3 as r,p as q,j as z,$ as B,e as V,m as R,a as P,Z as M,a0 as T,u as j,k as J}from"./index-ee9a4261.js";/* empty css               */import{E as O,b as Q,a as W}from"./element-china-area-data-bd0118c9.js";import{E as F}from"./index-d37bbe39.js";import{E as Z,a as G}from"./form-item-c20a48e0.js";/* empty css              */import"./scrollbar-7efc308d.js";import"./tag-22fde20f.js";import"./checkbox-91a85363.js";import"./radio-3168007b.js";import{E as H}from"./index-eb89c5ee.js";import"./index-f5ca2c44.js";import"./strings-938de866.js";import"./isEqual-5a33b929.js";import"./index-ea6229be.js";import"./event-fbb285ad.js";import"./focus-trap-87bffed9.js";import"./vnode-18385f06.js";import"./index-3745f2f9.js";import"./use-form-item-d271546b.js";import"./debounce-ea94ab5e.js";import"./icon-28d7bd83.js";import"./refs-a170700b.js";import"./index-1e3f29bd.js";import"./castArray-f5426a68.js";const I=m=>(q("data-v-9c6063fa"),m=m(),z(),m),K={class:"cut"},X={key:0,class:"addressWrapper"},Y=["onClick"],ee=I(()=>e("span",null,[a("收"),e("i"),a("货"),e("i"),a("人：")],-1)),te=I(()=>e("span",null,"联系方式：",-1)),oe=I(()=>e("span",null,"收货地址：",-1)),se={key:1,class:"empty"},le={class:"dialog-footer"},ae={__name:"CutDialog",props:{receList:{type:Array,default:()=>[]}},emits:["cutAddress"],setup(m,{emit:w}){const b=m,l=x(!1),p=x({}),u=S=>{p.value=S},c=()=>{p.value.phone&&w("cutAddress",p.value),l.value=!1};return(S,y)=>{const t=F,k=O;return g(),h("div",K,[s(t,{size:"large",onClick:y[0]||(y[0]=n=>l.value=!0)},{default:i(()=>[a("选择地址")]),_:1}),s(k,{modelValue:l.value,"onUpdate:modelValue":y[2]||(y[2]=n=>l.value=n),"lock-scroll":!1,title:"选择收货地址",width:"30%",center:""},{footer:i(()=>[e("span",le,[s(t,{onClick:y[1]||(y[1]=n=>l.value=!1)},{default:i(()=>[a("取消")]),_:1}),s(t,{type:"primary",onClick:c},{default:i(()=>[a("确定")]),_:1})])]),default:i(()=>[b.receList.length>0?(g(),h("div",X,[(g(!0),h(U,null,N(b.receList,n=>(g(),h("div",{class:$(["text item",{active:p.value.id===n.id}]),onClick:C=>u(n),key:n.id},[e("ul",null,[e("li",null,[ee,a(r(n.consignee),1)]),e("li",null,[te,a(r(n.phone),1)]),e("li",null,[oe,a(r(n.area+n.address),1)])])],10,Y))),128))])):(g(),h("div",se,"暂无地址，去添加吧！"))]),_:1},8,["modelValue"])])}}},ne=A(ae,[["__scopeId","data-v-9c6063fa"]]),de={class:"cut"},ie={class:"dialog-footer"},re={__name:"AddDialog",emits:["updateList"],setup(m,{emit:w}){const b=B(),l=x(),p=x(!1),u=x({phone:"",consignee:"",area:[],address:""}),c={consignee:[{required:!0,message:"请输入收货人",trigger:"blur"},{min:1,max:8,message:"收货人必须是 1-8位 的字符",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的联系电话",trigger:"blur"}],area:[{required:!0,message:"请选择收货区域",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}]},S=async()=>{await l.value.validate(),await b.addRece(u.value),R("添加地址成功"),p.value=!1,l.value.resetFields(),b.getReceList(),w("updateList")};return(y,t)=>{const k=F,n=H,C=Z,L=W,E=G,f=O;return g(),h("div",de,[s(k,{size:"large",onClick:t[0]||(t[0]=o=>p.value=!0)},{default:i(()=>[a("添加地址")]),_:1}),s(f,{modelValue:p.value,"onUpdate:modelValue":t[6]||(t[6]=o=>p.value=o),"lock-scroll":!1,title:"添加收货地址",width:"30%",center:""},{footer:i(()=>[e("span",ie,[s(k,{onClick:t[5]||(t[5]=o=>p.value=!1)},{default:i(()=>[a("取消")]),_:1}),s(k,{type:"primary",onClick:S},{default:i(()=>[a("确定")]),_:1})])]),default:i(()=>[s(E,{model:u.value,rules:c,ref_key:"receForm",ref:l,autocomplete:"off"},{default:i(()=>[s(C,{label:"收 货 人",prop:"consignee"},{default:i(()=>[s(n,{modelValue:u.value.consignee,"onUpdate:modelValue":t[1]||(t[1]=o=>u.value.consignee=o)},null,8,["modelValue"])]),_:1}),s(C,{label:"联系电话",prop:"phone"},{default:i(()=>[s(n,{modelValue:u.value.phone,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value.phone=o)},null,8,["modelValue"])]),_:1}),s(C,{label:"选择地区",prop:"area"},{default:i(()=>[s(L,{size:"large",options:V(Q),modelValue:u.value.area,"onUpdate:modelValue":t[3]||(t[3]=o=>u.value.area=o)},null,8,["options","modelValue"])]),_:1}),s(C,{label:"详细地址",prop:"address"},{default:i(()=>[s(n,{modelValue:u.value.address,"onUpdate:modelValue":t[4]||(t[4]=o=>u.value.address=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};const _=m=>(q("data-v-ac680e04"),m=m(),z(),m),ue={class:"checkout"},ce={class:"container"},_e={class:"layout"},pe=_(()=>e("h3",{class:"box-title"},"收货地址",-1)),me={class:"box-body"},ve={class:"address"},ge={class:"text"},he={key:0},fe=_(()=>e("i",null,null,-1)),be=_(()=>e("i",null,null,-1)),ye={key:1,class:"none"},ke={class:"action"},xe=_(()=>e("h3",{class:"box-title"},"商品信息",-1)),Ce={class:"box-body"},Se={class:"goods"},$e=_(()=>e("thead",null,[e("tr",null,[e("th",{width:"520"},"商品信息"),e("th",{width:"170"},"单价"),e("th",{width:"170"},"数量"),e("th",{width:"170"},"小计"),e("th",{width:"170"},"实付")])],-1)),Ve=["src"],we={class:"right"},Le={class:"g_name"},Ee={class:"g_ed"},De={class:"g_co"},Re={style:{color:"crimson","font-weight":"bold"}},Fe=_(()=>e("h3",{class:"box-title"},"配送时间",-1)),Ie={class:"box-body"},Ae=_(()=>e("h3",{class:"box-title"},"支付方式",-1)),Ue={class:"box-body"},Ne=_(()=>e("span",{style:{color:"#999"}},"货到付款需付5元手续费",-1)),qe=_(()=>e("h3",{class:"box-title"},"金额明细",-1)),ze={class:"box-body"},Be={class:"total"},Oe=_(()=>e("dt",null,"商品件数：",-1)),Pe=_(()=>e("dt",null,"商品总价：",-1)),Me=_(()=>e("dl",null,[e("dt",null,[a("运"),e("i"),a("费：")]),e("dd",null,"¥ 10")],-1)),Te=_(()=>e("dt",null,"应付总额：",-1)),je={class:"price"},Je={class:"submit"},Qe={__name:"index",setup(m){const w=P(),b=B(),l=M(),p=T(),u=j(),c=x({});w.token&&l.getCartSubmit(),l.cartSubmit.list.length<1&&u.replace("/cart");const S=()=>{b.receList.length>0&&(c.value=b.receList[0])};S();const y=f=>{c.value=f},t=x(1),k=x(1),n=f=>{t.value=f},C=f=>{k.value=f},L=new Date,E=async()=>{if(!c.value.phone)return R("请填写收货地址");const f=x({...c.value,total_num:l.cartSubmit.totalNum,total_price:l.cartSubmit.totalPrice+10,pay_method:"未支付",creat_date:L.toLocaleString(),goods_list:JSON.stringify(l.cartSubmit.list.map(v=>({id:v.id,uid:v.uid,gid:v.goods_id,goods_img:v.goods_img.substring(14),goodsname:v.goodsname,price:v.price,goods_num:v.goods_num,goods_edition:v.goods_edition,goods_color:v.goods_color})))}),D=(await p.addOrder(f.value)).data.id;l.getCartList(),R("订单创建成功"),u.replace({path:"/pay",query:{id:D}})};return(f,o)=>{const D=J("RouterLink"),v=F;return g(),h("div",ue,[e("div",ce,[e("div",_e,[pe,e("div",me,[e("div",ve,[e("div",ge,[c.value.phone?(g(),h("ul",he,[e("li",null,[e("span",null,[a("收"),fe,a("货"),be,a("人："+r(c.value.consignee),1)])]),e("li",null,[e("span",null,"联系方式："+r(c.value.phone),1)]),e("li",null,[e("span",null,"收货地址："+r(c.value.area+c.value.address),1)])])):(g(),h("div",ye,"您需要先选择收货地址才可提交订单。"))]),e("div",ke,[s(ne,{receList:V(b).receList,onCutAddress:y},null,8,["receList"]),s(re,{onUpdateList:S})])])]),xe,e("div",Ce,[e("table",Se,[$e,e("tbody",null,[(g(!0),h(U,null,N(V(l).cartSubmit.list,d=>(g(),h("tr",{key:d.id},[e("td",null,[s(D,{to:"/detail/"+d.goods_id,target:"_blank",class:"info"},{default:i(()=>[e("img",{src:d.goods_img,alt:""},null,8,Ve),e("div",we,[e("p",null,[e("span",Le,r(d.goodsname),1)]),e("p",null,[a(" 型号："),e("span",Ee,r(d.goods_edition),1)]),e("p",null,[a(" 颜色："),e("span",De,r(d.goods_color),1)])])]),_:2},1032,["to"])]),e("td",null,"¥ "+r(d.price),1),e("td",null,r(d.goods_num),1),e("td",null,"¥ "+r(d.price*d.goods_num),1),e("td",Re," ¥ "+r(d.price*d.goods_num),1)]))),128))])])]),Fe,e("div",Ie,[e("span",{class:$([{active:t.value===1},"my-btn"]),onClick:o[0]||(o[0]=d=>n(1))}," 不限送货时间：周一至周日 ",2),e("span",{class:$([{active:t.value===2},"my-btn"]),onClick:o[1]||(o[1]=d=>n(2))}," 工作日送货：周一至周五 ",2),e("span",{class:$([{active:t.value===3},"my-btn"]),onClick:o[2]||(o[2]=d=>n(3))}," 双休日、假日送货：周六至周日 ",2)]),Ae,e("div",Ue,[e("span",{class:$([{active:k.value===1},"my-btn"]),onClick:o[3]||(o[3]=d=>C(1))}," 在线支付 ",2),e("span",{class:$([{active:k.value===2},"my-btn"]),onClick:o[4]||(o[4]=d=>C(2))}," 货到付款 ",2),Ne]),qe,e("div",ze,[e("div",Be,[e("dl",null,[Oe,e("dd",null,r(V(l).cartSubmit.totalNum)+" 件",1)]),e("dl",null,[Pe,e("dd",null,"¥ "+r(V(l).cartSubmit.totalPrice.toFixed(2)),1)]),Me,e("dl",null,[Te,e("dd",je," ¥ "+r((V(l).cartSubmit.totalPrice+10).toFixed(2)),1)])])]),e("div",Je,[s(v,{onClick:E,type:"primary",size:"large"},{default:i(()=>[a("提交订单")]),_:1})])])])])}}},ft=A(Qe,[["__scopeId","data-v-ac680e04"]]);export{ft as default};
